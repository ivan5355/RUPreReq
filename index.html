<!DOCTYPE html>
<html>
<head>
    <title>Course Prerequisites Visualization</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.23.0/cytoscape.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dagre@0.8.5/dist/dagre.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cytoscape-dagre@2.5.0/cytoscape-dagre.min.js"></script>
    <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>
    <script src="https://unpkg.com/cytoscape-dagre/cytoscape-dagre.js"></script>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XE78N8F328"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-XE78N8F328');
    </script>
    
    <style>

        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
        }

        .header {
            background-color: #cc0033; 
            color: white;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
 
        .controls {
            background-color: white;
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }

        select, input {
            padding: 8px 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            min-width: 200px;
        }
        button {
            padding: 8px 20px;
            background-color: #cc0033;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #990026;
        }

        #cy {
            width: 100%;
            height: calc(100vh - 130px);
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .disclaimer {
            text-align: center;
            margin: 20px 0;
            font-size: 12px;
            color: #555;
        }

    </style>
</head>

<body>
    <div class="header">
        <h1>Rutgers Course Prerequisites Visualization</h1>
        <p><strong>Disclaimer:</strong> This platform is not affiliated with Rutgers University.</p>
    </div>
    
    <div class="controls">
        <select id="majorSelect">
            <option value="">Select a Major</option>
            <option value="010">Accounting</option>
            <option value="011">Administrative Studies</option>
            <option value="016">African Studies</option>
            <option value="013">African, Middle Eastern, and South Asian Languages and Literatures</option>
            <option value="014">Africana Studies</option>
            <option value="035">Agricultural and Natural Resource Management</option>
            <option value="020">Agriculture and Food Systems</option>
            <option value="047">Alcohol Studies</option>
            <option value="050">American Studies</option>
            <option value="067">Animal Science</option>
            <option value="070">Anthropology</option>
            <option value="074">Arabic Languages</option>
            <option value="078">Armenian</option>
            <option value="080">Art</option>
            <option value="081">Art</option>
            <option value="082">Art History</option>
            <option value="090">Arts and Sciences</option>
            <option value="098">Asian Studies</option>
            <option value="115">Biochemistry</option>
            <option value="117">Bioenvironmental Engineering</option>
            <option value="119">Biological Sciences</option>
            <option value="122">Biomathematics</option>
            <option value="125">Biomedical Engineering</option>
            <option value="126">Biotechnology</option>
            <option value="136">Business Analytics and Information Technology</option>
            <option value="140">Business Law</option>
            <option value="146">Cell Biology and Neuroscience</option>
            <option value="158">Chemical Biology</option>
            <option value="155">Chemical and Biochemical Engineering</option>
            <option value="160">Chemistry</option>
            <option value="165">Chinese</option>
            <option value="175">Cinema Studies</option>
            <option value="180">Civil and Environmental Engineering</option>
            <option value="190">Classics</option>
            <option value="185">Cognitive Science</option>
            <option value="192">Communication</option>
            <option value="189">Communication and Media Studies</option>
            <option value="193">Community Health Outreach</option>
            <option value="195">Comparative Literature</option>
            <option value="198">Computer Science</option>
            <option value="202">Criminal Justice</option>
            <option value="203">Dance</option>
            <option value="206">Dance</option>
            <option value="207">Dance Education</option>
            <option value="219">Data Science</option>
            <option value="216">Ecology, Evolution and Natural Resources</option>
            <option value="220">Economics</option>
            <option value="300">Education</option>
            <option value="364">Educational Opportunity Fund</option>
            <option value="332">Electrical and Computer Engineering</option>
            <option value="355">English - Composition and Writing</option>
            <option value="351">English - Creative Writing</option>
            <option value="354">English - Film Studies</option>
            <option value="358">English - Literature</option>
            <option value="359">English - Theories and Methods</option>
            <option value="356">English as a Second Language</option>
            <option value="370">Entomology</option>
            <option value="382">Entrepreneurship</option>
            <option value="573">Environmental Planning and Design</option>
            <option value="374">Environmental Policy, Institutions and Behavior</option>
            <option value="375">Environmental Sciences</option>
            <option value="381">Environmental Studies</option>
            <option value="015">Environmental and Biological Sciences</option>
            <option value="373">Environmental and Business Economics</option>
            <option value="522">Ethics in Business Environment</option>
            <option value="360">European Studies</option>
            <option value="377">Exercise Science</option>
            <option value="211">Filmmaking</option>
            <option value="390">Finance</option>
            <option value="400">Food Science</option>
            <option value="420">French</option>
            <option value="440">General Engineering</option>
            <option value="447">Genetics</option>
            <option value="450">Geography</option>
            <option value="460">Geological Sciences</option>
            <option value="470">German</option>
            <option value="490">Greek</option>
            <option value="489">Greek, Modern</option>
            <option value="501">Health Administration</option>
            <option value="505">Hindi</option>
            <option value="510">History</option>
            <option value="508">History - Africa, Asia, Latin America</option>
            <option value="512">History - American</option>
            <option value="506">History - General/Comparative</option>
            <option value="533">Human Resource Management</option>
            <option value="535">Hungarian</option>
            <option value="540">Industrial and Systems Engineering</option>
            <option value="547">Information Technology and Informatics</option>
            <option value="557">Interdisciplinary - Mason Gross</option>
            <option value="554">Interdisciplinary Studies</option>
            <option value="556">Interdisciplinary Studies - Arts and Sciences</option>
            <option value="558">International Studies</option>
            <option value="560">Italian</option>
            <option value="565">Japanese</option>
            <option value="563">Jewish Studies</option>
            <option value="567">Journalism and Media Studies</option>
            <option value="574">Korean</option>
            <option value="575">Labor Studies</option>
            <option value="550">Landscape Architecture</option>
            <option value="617">Languages and Cultures</option>
            <option value="580">Latin</option>
            <option value="590">Latin American Studies</option>
            <option value="595">Latino and Hispanic Caribbean Studies</option>
            <option value="607">Leadership Skills</option>
            <option value="615">Linguistics</option>
            <option value="620">Management</option>
            <option value="624">Management and Work</option>
            <option value="628">Marine Sciences</option>
            <option value="630">Marketing</option>
            <option value="635">Materials Science and Engineering</option>
            <option value="640">Mathematics</option>
            <option value="650">Mechanical and Aerospace Engineering</option>
            <option value="652">Medical Ethics and Policy</option>
            <option value="667">Medieval Studies</option>
            <option value="670">Meteorology</option>
            <option value="680">Microbiology</option>
            <option value="685">Middle Eastern and Islamic Studies</option>
            <option value="690">Military Education, Air Force</option>
            <option value="691">Military Education, Army</option>
            <option value="692">Military Education, Navy</option>
            <option value="694">Molecular Biology and Biochemistry</option>
            <option value="700">Music</option>
            <option value="701">Music, Applied</option>
            <option value="705">Nursing</option>
            <option value="709">Nutritional Sciences</option>
            <option value="713">Organizational Leadership</option>
            <option value="723">Persian</option>
            <option value="715">Pharmaceutical Chemistry</option>
            <option value="721">Pharmaceutics</option>
            <option value="718">Pharmacology, Cellular and Molecular</option>
            <option value="720">Pharmacy</option>
            <option value="725">Pharmacy Practice and Administration</option>
            <option value="730">Philosophy</option>
            <option value="745">Physician Assistant</option>
            <option value="750">Physics</option>
            <option value="762">Planning and Public Policy</option>
            <option value="776">Plant Science</option>
            <option value="775">Policy, Health, and Administration</option>
            <option value="787">Polish</option>
            <option value="790">Political Science</option>
            <option value="810">Portuguese</option>
            <option value="830">Psychology</option>
            <option value="843">Public Administration and Management</option>
            <option value="832">Public Health</option>
            <option value="833">Public Policy</option>
            <option value="851">Real Estate</option>
            <option value="840">Religion</option>
            <option value="860">Russian</option>
            <option value="902">SEBS Internship</option>
            <option value="904">Social Justice</option>
            <option value="910">Social Work</option>
            <option value="920">Sociology</option>
            <option value="940">Spanish</option>
            <option value="955">Sport Management</option>
            <option value="960">Statistics</option>
            <option value="959">Study Abroad</option>
            <option value="799">Supply Chain and Marketing Science</option>
            <option value="965">Theater</option>
            <option value="966">Theater Arts</option>
            <option value="973">Turkish</option>
            <option value="971">Urban Planning and Design</option>
            <option value="975">Urban Studies and Community Development</option>
            <option value="988">Women's, Gender, and Sexuality Studies</option>
            <option value="991">World Languages</option>
        </select>
        <button onclick="searchCourses()">Search Subjects</button>
    </div>

    <div id="cy"></div>

    <script>
        let cy;

        
        async function searchCourses() {
            
            //subject user selects
            const majorNumber = document.getElementById('majorSelect').value;

            //If user clicks button but does not select major
            if (!majorNumber) {
                alert('Please select a major.');
                document.querySelector('.loading').style.display = 'none';
                return;
            }

            try {

                const response = await fetch(`/api/graph/${majorNumber}`);

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
            
                const data = await response.json();

                 // Define the elements (nodes and edges) for the Cytoscape graph
                const elements = {
                    nodes: data.nodes,
                    edges: data.edges
                };

                // If the graph already exist destroy it before creating a new one
                if (cy) {
                    cy.destroy();
                }
                
                cy = cytoscape({
                    container: document.getElementById('cy'),
                    elements: elements,
                    style: [
                        {
                            selector: 'node',
                            style: {
                                'label': 'data(label)',// Set the label to the 'label' data field
                                'text-wrap': 'wrap', // Wrap the text inside nodes
                                'font-size': '16px',
                                'text-valign': 'center',
                                'text-halign': 'center',
                                'background-color': '#6FB1FC',
                                'width': '100px',
                                'height': '100px',
                                'border-width': '2px',
                                'border-color': '#555',
                                'text-max-width': '80px' //max width that the text is allowed to be 
                            }
                        },
                        {
                            selector: 'edge',
                            style: {
                                'width': 1.5,
                                'line-color': '#000000',
                                'curve-style': 'bezier',
                                'opacity': 0.7,
                                'source-arrow-shape': 'triangle',
                                'source-arrow-color': '#000000',
                                'arrow-scale': 1.5, 
                            }
                        }
                    ],
                    layout: {
                        name: 'dagre', //arranges the nodes in a way that minimizes edge crossings and ensures that the edges flow in one direction. Ment for directed graphs.
                        rankDir: 'TB',// Specifies that direction in which nodes should be arranged within the layout is top to bottom
                        fit: true // scales view so that all nodes and edges are visible within the defined area
                    }
                });

            } catch (error) {
                console.error('Error loading search results:', error);
                alert('Error loading course data. Please try again.');
            } finally {
                document.querySelector('.loading').style.display = 'none';
            }
        }
    </script>
</body>
</html> 